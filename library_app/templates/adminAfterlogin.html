{% extends 'navbar.html' %}
{%load static%}
{% block content %}
<style>
  .adback {
    background-image: url('/static/img/librarian.gif');
    background-attachment: fixed;
    background-size: cover;
    background-repeat: no-repeat;
  }

  .tab {
    background-color: rgba(32, 35, 33, 0.792);
    margin-top: 10px;
  }

  .tab h1,
  h2 {
    text-align: center;
    color: white;
  }
</style>
<div class="container-fluid border-top">
  <div class="row">
    <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-dark sidebar collapse mheight-100"
      style="overflow:auto; position:fixed;">
      <div class="position-sticky pt-3 sidebar-sticky">
        <div class="nav flex-column">
          <a href="{%url 'Dashboard'%}" class="btn btn-primary btn-lg active" role="button" aria-pressed="true">My
            Profile</a><br><br>
          <div class="options" style="text-align:center">
            <a href="{%url 'chat'%}" class="btn btn-info btn-sm " role="button" aria-pressed="true">Library Chat
              Group</a><br><br>
            <a href="{%url 'adBo'%}" class="btn btn-warning btn-sm " role="button" aria-pressed="true">Add Book To
              Library</a><br><br>
            <a href="{%url 'availableBo'%}" class="btn btn-warning btn-sm " role="button" aria-pressed="true">View
              Available Books in Library</a><br><br>
            <a href="{%url 'isuBo'%}" class="btn btn-warning btn-sm " role="button" aria-pressed="true">Issue book to
              student</a><br><br>
            <a href="{%url 'viewissued'%}" class="btn btn-warning btn-sm" role="button" aria-pressed="true">View Books
              issued to students</a><br><br>
            <a href="{%url 'viewStud'%}" class="btn btn-warning btn-sm" role="button" aria-pressed="true">View our
              students</a><br><br>
            <a href="{%url 'Bookrequested'%}" class="btn btn-warning btn-sm" role="button" aria-pressed="true">View
              Students Who requested book</a>

          </div>
        </div>
        <hr style="background: black; padding:5px;">
        <h6
          class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted text-uppercase">
          <span>Saved reports</span>
          <a class="link-secondary" href="#" aria-label="Add a new report">
            <span data-feather="plus-circle" class="align-text-bottom"></span>
          </a>
        </h6>
        <ul class="nav flex-column mb-2">
          <li class="nav-item">
            <a class="nav-link" href="{%url 'topdf'%}">
              <span data-feather="file-text" class="align-text-bottom"></span>
              Weekly Report summary
            </a>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="file-text" class="align-text-bottom"></span>
              Borrow Chart Summary
            </a>
          </li>
        </ul>
      </div>
    </nav>
    <!--row2-->

    <!--Part of admin dashboard-->
    <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4 adback" style="height: 38rem; overflow:auto;">
      <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <form method="post" action="{%url 'stupdate'%}" enctype="multipart/form-data">
            {%csrf_token%}
            <div class="modal-content">
              <div class="modal-header">
                <h1 class="modal-title fs-5" id="exampleModalLabel">My Profile</h1>&nbsp; &nbsp;&nbsp;&nbsp;<a
                  href="{%url 'stupdate'%}">Load data</a>
                <p class="text-warning">``To update your profile you have to load data firsrt!!</p>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <div class="mb-3">
                  {{form1.as_p}}
                </div>
              </div>
              <div class="modal-footer">

                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
                <button type="submit" class="btn btn-success">Save Changes</button>
              </div>
            </div>
          </form>
        </div>
      </div>
      {%if page11 == "Dashboard"%}
      <div
        class="d-flex justify-content-center flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom border-top bg-warning rounded-3 border shadow-lg">

        <h1 class="h2 text-light">Welcome Librarian &nbsp; {{user.first_name}} &nbsp; {{user.last_name}}</h1>
        <div class="btn-toolbar mb-2 mb-md-0">
        </div>
      </div>
      <p class="lead text-light">
        As you are Librarian, you have right to add book to library, view books available in library
        and all access roles as states on this left menu bar!
      </p>
      {%include 'partials/messages.html'%}
      <div class="d-flex flex-row justify-content-between">
        <div class="col-md-7">
          <div class="position-sticky" style="top: 2rem;">
            <div class="p-4 mb-3 bg-light rounded">
              <h4 class="fst-italic">My Role</h4>
              <p class="mb-4">
                <b>Cataloging and Classification:</b> This dashboard will help you to organize and categorize library
                resources based on various parameters such as title, author, subject, and ISBN.
              </p>
              <p class="mb-4">
                <b>Circulation Management:</b> This feature allows you to handle the process of issuing and returning
                books and managing fines or penalties.
              </p>
            </div>
          </div>
        </div>
        <!-- update profile part -->

        <!--student profile 2-->
        <div class="col-md-5 col-lg-4 order-md-last">
          <h4 class="d-flex justify-content-between align-items-center mb-0 bg-warning">
            <span class="text-light">&nbsp;&nbsp; My Information</span>
            <span class="badge"><img src="{%static 'img/ME.jpg'%}" alt="" width="50" height="50" class="rounded-circle">
            </span>
          </h4>
          <ul class="list-group mb-3">
            <li class="list-group-item d-flex justify-content-between lh-sm">
              <div>
                <h6 class="my-0">Profile</h6>
                <small class="text-muted">Librarian</small>
              </div>
            </li>
            <li class="list-group-item d-flex justify-content-between lh-sm">
              <div>
                <h6 class="my-0">First Name</h6>
                <small class="text-muted">{{user.first_name}}</small>
              </div>
            </li>
            <li class="list-group-item d-flex justify-content-between lh-sm">
              <div>
                <h6 class="my-0">Last Name</h6>
                <small class="text-muted">{{user.last_name}}</small>
              </div>
            </li>

          </ul>
          <form class="card p-2" method="post" action="{%url 'chat'%}">
            {%csrf_token%}
            <div class="input-group">
              <input type="text" class="form-control" placeholder="Chat with students" name="message" required>
              <button class="btn btn-warning tm-search-btn" type="submit">Chat</button>
            </div>
          </form>
        </div>
      </div>
      <!-- ====Calender -->
      <div class="calendar"></div>
      <!--Adding book to library-->
      {%elif page2 == "adBo" or page22 == "EditBo"%}
      <div class="container mt-3 mb-5 tab" style="height: 35rem; overflow:hidden;">
        <div class="row p-0 pb-0 pe-lg-0 pt-lg-0 align-items-center rounded-3 border shadow-lg">
          <div class="container col-xl-10 col-xxl-8 px-4 py-5 bg-tertiary">
            <div class="row g-lg-5 py-0">
              <div class="col-lg-7 text-lg-start">
                <h2 class="col-6 tm-text-light">Add or Update Book in library</h2>
                <div class="col-lg-10">
                  <img src="{%static '/img/addbook.gif'%}" width="100%" height="100%" alt=""><br><br>
                </div>
                <p class="col-lg-10 fs-4 text-light">As a Librarian now you have right and access to add or update books
                  in library</p>
              </div>
              <div class="col-md-10 mx-auto col-lg-5" style="height: 30rem; overflow:auto;">
                <form class="p-4 p-md-5 border rounded-3 bg-light" method="post" action=""
                  enctype="multipart/form-data">
                  {% csrf_token %}
                  {{addbooks.as_p}}
                  <button class="w-100 btn btn-lg btn-warning" type="submit">Add / Update Book</button>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!--Book added message-->
      {%elif page222 == "addedto"%}
      <div class="container my-5 tab">
        <div class="row p-0 pb-0 pe-lg-0 pt-lg-0 align-items-center rounded-3 border shadow-lg">
          <div class="container col-xl-10 col-xxl-8 px-4 py-5 bg-tertiary">
            <div class="row g-lg-5 py-0">
              {%include 'partials/messages.html'%}

              <div class="options" style="text-align:center">
                <a href="{%url 'adBo'%}" class="btn btn-primary btn-lg active" role="button" aria-pressed="true">Click
                  here to add more Book</a><br><br>
                <a href="{%url 'availableBo'%}" class="btn btn-primary btn-lg active" role="button"
                  aria-pressed="true">Click here to view Book in Library</a><br><br>
              </div>
              <br>
            </div>
          </div>
        </div>
      </div>

      {%elif page3 == "availableBo"%}
      <!--Available books in library displayed in form of table-->
      <div class="container my-3 tab">
        <div class="row p-0 pb-0 pe-lg-0 pt-lg-0 align-items-center rounded-0 border shadow-lg">
          <h2>Available Books in Library and here you can edit or delete a book</h2><br>
          <div class="table-responsive">
            {%if avaibook%}
            <table class="table table-striped table-sm">
              <thead>
                <tr>
                  <th scope="col">Book isbn</th>
                  <th scope="col">Title</th>
                  <th scope="col">Author</th>
                  <th scope="col">Category</th>
                  <th scope="col">Date Published</th>
                  <th scope="col" colspan="2">Actions</th>
                </tr>
              </thead>
              <tbody>
                {%for book in avaibook%}
                <tr>
                  <td>{{book.isbn}}</td>
                  <td>{{book.name}}</td>
                  <td>{{book.author}}</td>
                  <td>{{book.category.name}}</td>
                  <td>{{book.published}}</td>
                  <td><a href="{%url 'EditBo' book.id%}">Edit</a></td>
                  <td><a href="{%url 'Delet' book.id%}">Delete</a></td>
                </tr>
                {%endfor%}
              </tbody>
            </table>
            {%else%}
            <h1>Have 0 book in library</h1>
            {%endif%}
          </div>
        </div>
      </div>
      <!--Page for issuing a book to the student-->
      {%elif page4 == "isuBo"%}
      <div class="container mt-3 tab">
        <div class="row p-0 pb-0 pe-lg-0 pt-lg-0 align-items-center rounded-3 border shadow-lg">
          <div class="container col-xl-10 col-xxl-8 px-4 py-2 bg-tertiary">
            <div class="row align-items-center g-lg-5 py-0">
              <div class="col-lg-7 text-center text-lg-start">
                <h2 class="display-4 fw-bold lh-1 mb-3">Issue a book to student!!!</h2>
                <div class="col-lg-10">
                  <img src="{%static '/img/issueBook.gif'%}" width="100%" height="100%" alt=""><br><br>
                </div>

              </div>

              <div class="col-md-10 mx-auto col-lg-5">
                <form class="p-4 p-md-5 border rounded-3 bg-light" method="post" action="">
                  {%csrf_token%}
                  <div class="form-floating mb-3">
                    {{form.as_p}}
                  </div>
                  <button class="w-100 btn btn-lg btn-warning" type="submit">Issue a Book to Student</button><br><br>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>

      {%elif page44 == "viewissued"%}
      <!--View books issued to student done by librarian-->
      <div class="container my-3 tab">
        <div class="row p-0 pb-0 pe-lg-0 pt-lg-0 align-items-center rounded-0 border shadow-lg">
          <a href="{%url 'topdf'%}" class="btn btn-sm btn-success " style="float: left;">Export The Report summary to
            pdf Document</a>
          <h2>List of Books issued to Students</h2><br>
          {%include 'partials/messages.html'%}
          <div class="table-responsive">
            {%if issuedbooks%}
            <table class="table table-striped table-lg bg-success">
              <thead>
                <tr>
                  <th>Student Id</th>
                  <th>Student Name</th>
                  <th>Student School</th>
                  <th>Student Department</th>
                  <th>Book isbn</th>
                  <th>Book Name</th>
                  <th>Book Author</th>
                  <th>Issued Date</th>
                  <th>Date to return Book</th>
                  <th>Fine</th>
                  <th>Status</th>
                  <th>action</th>
                </tr>
              </thead>
              <tbody>
                {% for book in issuedbooks %}
                <tr>
                  <td>{{book.student.student.id}}</td>
                  <td>{{book.student.student.first_name}}</td>
                  <td>{{book.student.school}}</td>
                  <td>{{book.student.department}}</td>
                  <td>{{book.book.isbn}}</td>
                  <td>{{book.book.name}}</td>
                  <td>{{book.book.author}}</td>
                  <td>{{book.issuedate}}</td>
                  <td>{{book.expiredate}}</td>
                  <td>{{book.fines}}</td>
                  <td>{{book.status}}</td>
                  <td><a href="{%url 'remb' book.id%}">Student returned this book</a></td>
                  {%endfor%}
              </tbody>
            </table>
            {%else%}
            <h1 class="text-warning">``0 books Issued ``</h1>
            {%endif%}
          </div>
        </div>s
      </div>

      <!--View student using librarian panel-->
      {%elif page5 == "viewStud"%}
      <div class="container my-3 tab">
        <div class="row p-0 pb-0 pe-lg-0 pt-lg-0 align-items-center rounded-0 border shadow-lg">
          <h2>Students who are members of our library</h2><br>
          <div class="table-responsive">
            {%if students%}
            <table class="table table-striped table-sm">
              <thead>
                <tr>
                  <th scope="col">Stud Id</th>
                  <th scope="col">First Name</th>
                  <th scope="col">Last Name</th>
                  <th scope="col">School</th>
                  <th scope="col">Department</th>
                </tr>
              </thead>
              <tbody>
                {%for student in students%}
                <tr>
                  <td>{{student.student.id}}</td>
                  <td>{{student.student.first_name}}</td>
                  <td>{{student.student.last_name}}</td>
                  <td>{{student.school}}</td>
                  <td>{{student.department}}</td>
                </tr>
                {%endfor%}
              </tbody>
            </table>
            {%else%}
            <h1 class="text-warning">``0 students in our system``</h1>
            {%endif%}
            <!-- The list of students who requested to borrow a book -->
            {%elif page55 == "Bookreq"%}
            <div class="container my-3 tab">
              <div class="row p-0 pb-0 pe-lg-0 pt-lg-0 align-items-center rounded-0 border shadow-lg">
                <h2>The following list shows the students who requested to borrow different books</h2><br>
                <div class="table-responsive">
                  {%if reques%}
                  <table class="table table-striped table-sm">
                    <thead>
                      <tr>
                        <th>Stud id</th>
                        <th>First Name</th>
                        <th>Last Name</th>
                        <th>School</th>
                        <th>Department</th>
                        <th>Book Name</th>
                        <th>Book Isbn</th>
                        <th>Book Author</th>
                        <th>Request id</th>
                        <th>Request Date</th>
                        <th scope="col" colspan="2">Actions</th>
                      </tr>
                    </thead>
                    <tbody>
                      {%for book in reques%}
                      <tr>
                        <td>{{book.student.student.id}}</td>
                        <td>{{book.student.student.first_name}}</td>
                        <td>{{book.student.student.last_name}}</td>
                        <td>{{book.student.school}}</td>
                        <td>{{book.student.department}}</td>
                        <td>{{book.book.name}}</td>
                        <td>{{book.book.isbn}}</td>
                        <td>{{book.book.author}}</td>
                        <td>{{book.statusoption}}</td>
                        <td>{{book.borrowdate}}</td>
                        <td><a href="{%url 'AcceptStudentreq' book.id%}">Issue this book </a></td>
                        <td><a href="{%url 'cancelrequested' book.id%}">Decline request</a></td>
                      </tr>
                      {%endfor%}
                    </tbody>
                  </table>
                  {%else%}
                  <h1 class="text-warning">``No student who requested to borrow a book``</h1>
                  {%endif%}
                </div>
              </div>
            </div>
            <!-- Accept student request for borrowing a book -->
            {%elif page6 == "acceptBo"%}
            <div class="container my-0 tab">
              <div class="row p-0 pb-0 pe-lg-0 pt-lg-0 align-items-center rounded-3 border shadow-lg">
                <div class="container col-xl-10 col-xxl-8 px-4 py-2 bg-tertiary">
                  <div class="row align-items-center g-lg-5 py-0">
                    <div class="col-lg-7 text-center text-lg-start">
                      <h1 class="display-4 fw-bold lh-1 mb-3">Accept Student request to borrow this book!!!</h1>
                      <div class="col-lg-10">
                        <img src="{{accept.book.photo.url}}" width="100%" height="100%" alt=""><br><br>
                      </div>
                      {%include 'partials/messages.html'%}
                    </div>

                    <div class="col-md-10 mx-auto col-lg-5" style="z-index: 0;">
                      <form class="p-4 p-md-5 border rounded-3 bg-light" method="post" action="">
                        {%csrf_token%}
                        <div class="form-floating mb-3">
                          <input type="email" class="form-control" id="floatingInput" name="name"
                            value="{{accept.student.student.first_name}}" required disabled>
                          <label for="floatingInput">Student Name</label>
                        </div>
                        <div class="form-floating mb-3">
                          <input type="email" class="form-control" id="floatingInput" name="book"
                            value="{{accept.book.name}}" required disabled>
                          <label for="floatingInput">Book Name</label>
                        </div>
                        <div class="form-floating mb-3">
                          <input type="email" class="form-control" id="floatingInput" name="book"
                            value="{{accept.statusoption}}" required disabled>
                          <label for="floatingInput">Status</label>
                        </div>
                        <button class="w-100 btn btn-lg btn-warning" type="submit">Issue This Book to
                          Student</button><br><br>
                        <a href="{%url 'Bookrequested'%}">Go Back</a>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            {%endif%}
    </main>
  </div>
</div>
{%include 'footer.html'%}
{%endblock%}